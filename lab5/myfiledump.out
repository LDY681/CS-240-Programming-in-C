0x0000000000000000: 0A 23 69 6E 63 6C 75 64 65 20 3C 73 74 64 69 6F  .#include <stdio
0x0000000000000010: 2E 68 3E 0A 23 69 6E 63 6C 75 64 65 20 3C 73 74  .h>.#include <st
0x0000000000000020: 72 69 6E 67 2E 68 3E 0A 23 69 6E 63 6C 75 64 65  ring.h>.#include
0x0000000000000030: 20 3C 73 74 64 6C 69 62 2E 68 3E 0A 0A 76 6F 69   <stdlib.h>..voi
0x0000000000000040: 64 20 66 69 6C 65 64 75 6D 70 28 63 68 61 72 20  d filedump(char 
0x0000000000000050: 2A 20 70 20 2C 20 69 6E 74 20 6C 65 6E 29 20 7B  * p , int len) {
0x0000000000000060: 0A 09 69 6E 74 20 69 3B 0A 09 69 6E 74 20 6C 6C  ..int i;..int ll
0x0000000000000070: 20 3D 20 30 3B 09 2F 2F 6C 65 6E 20 6C 6F 63 61   = 0;.//len loca
0x0000000000000080: 74 69 6F 6E 0A 09 77 68 69 6C 65 20 28 6C 6C 20  tion..while (ll 
0x0000000000000090: 3C 20 6C 65 6E 29 7B 0A 09 09 2F 2F 20 50 72 69  < len){...// Pri
0x00000000000000A0: 6E 74 20 61 64 64 72 65 73 73 20 6F 66 20 74 68  nt address of th
0x00000000000000B0: 65 20 62 65 67 69 6E 6E 69 6E 67 20 6F 66 20 70  e beginning of p
0x00000000000000C0: 2E 20 59 6F 75 20 6E 65 65 64 20 74 6F 20 70 72  . You need to pr
0x00000000000000D0: 69 6E 74 20 69 74 20 65 76 65 72 79 20 31 36 20  int it every 16 
0x00000000000000E0: 62 79 74 65 73 0A 09 09 70 72 69 6E 74 66 28 22  bytes...printf("
0x00000000000000F0: 30 78 25 30 31 36 6C 58 3A 20 22 2C 20 28 75 6E  0x%016lX: ", (un
0x0000000000000100: 73 69 67 6E 65 64 20 6C 6F 6E 67 29 20 20 6C 6C  signed long)  ll
0x0000000000000110: 29 3B 09 2F 2F 69 6E 63 72 65 6D 65 6E 74 20 61  );.//increment a
0x0000000000000120: 64 64 72 65 73 73 0A 09 09 2F 2F 20 50 72 69 6E  ddress...// Prin
0x0000000000000130: 74 20 66 69 72 73 74 20 62 79 74 65 20 61 73 20  t first byte as 
0x0000000000000140: 68 65 78 61 64 65 63 69 6D 61 6C 0A 09 09 66 6F  hexadecimal...fo
0x0000000000000150: 72 20 28 69 20 3D 20 6C 6C 3B 20 69 20 3C 20 6C  r (i = ll; i < l
0x0000000000000160: 65 6E 20 26 26 20 69 20 3C 20 6C 6C 20 2B 20 31  en && i < ll + 1
0x0000000000000170: 36 3B 20 69 2B 2B 29 7B 0A 09 09 09 69 6E 74 20  6; i++){....int 
0x0000000000000180: 63 20 3D 20 70 5B 69 5D 26 30 78 46 46 3B 0A 09  c = p[i]&0xFF;..
0x0000000000000190: 09 09 70 72 69 6E 74 66 28 20 22 25 30 32 58 20  ..printf( "%02X 
0x00000000000001A0: 22 2C 20 63 29 3B 0A 09 09 7D 0A 09 0A 09 09 2F  ", c);...}...../
0x00000000000001B0: 2F 49 64 65 6E 74 61 74 69 6F 6E 20 77 68 65 6E  /Identation when
0x00000000000001C0: 20 6C 65 73 73 20 74 68 61 6E 20 31 36 20 62 79   less than 16 by
0x00000000000001D0: 74 65 73 0A 09 09 69 6E 74 20 6A 20 3D 20 6C 65  tes...int j = le
0x00000000000001E0: 6E 3B 0A 09 09 77 68 69 6C 65 20 28 6A 20 3C 20  n;...while (j < 
0x00000000000001F0: 6C 6C 20 2B 20 31 36 29 7B 0A 09 09 09 6A 2B 2B  ll + 16){....j++
0x0000000000000200: 3B 0A 09 09 09 70 72 69 6E 74 66 28 22 25 73 20  ;....printf("%s 
0x0000000000000210: 22 2C 20 22 20 20 22 29 3B 09 2F 2F 61 64 64 20  ", "  ");.//add 
0x0000000000000220: 73 70 61 63 65 20 66 6F 72 20 6E 6F 20 63 6F 6E  space for no con
0x0000000000000230: 74 65 6E 74 20 62 6C 6F 63 6B 73 0A 09 09 7D 0A  tent blocks...}.
0x0000000000000240: 09 09 0A 09 09 70 72 69 6E 74 66 28 22 25 73 22  .....printf("%s"
0x0000000000000250: 2C 20 22 20 22 29 3B 09 2F 2F 73 70 61 63 65 20  , " ");.//space 
0x0000000000000260: 62 65 74 77 65 65 6E 20 62 79 74 65 73 20 61 6E  between bytes an
0x0000000000000270: 64 20 63 68 61 72 73 0A 0A 09 09 2F 2F 20 50 72  d chars....// Pr
0x0000000000000280: 69 6E 74 20 66 69 72 73 74 20 62 79 74 65 20 61  int first byte a
0x0000000000000290: 73 20 63 68 61 72 61 63 74 65 72 0A 09 09 66 6F  s character...fo
0x00000000000002A0: 72 20 28 69 20 3D 20 6C 6C 3B 20 69 20 3C 20 6C  r (i = ll; i < l
0x00000000000002B0: 65 6E 20 26 26 20 69 20 3C 20 6C 6C 20 2B 20 31  en && i < ll + 1
0x00000000000002C0: 36 3B 20 69 2B 2B 29 7B 0A 09 09 09 69 6E 74 20  6; i++){....int 
0x00000000000002D0: 63 20 3D 20 70 5B 69 5D 26 30 78 46 46 3B 0A 09  c = p[i]&0xFF;..
0x00000000000002E0: 09 09 70 72 69 6E 74 66 28 22 25 63 22 2C 20 28  ..printf("%c", (
0x00000000000002F0: 63 3E 3D 33 32 20 26 26 20 63 20 3C 20 31 32 37  c>=32 && c < 127
0x0000000000000300: 29 3F 63 3A 27 2E 27 29 3B 0A 09 09 7D 0A 09 09  )?c:'.');...}...
0x0000000000000310: 6C 6C 20 2B 3D 20 31 36 3B 0A 09 09 70 72 69 6E  ll += 16;...prin
0x0000000000000320: 74 66 28 22 5C 6E 22 29 3B 0A 09 7D 0A 7D 0A 0A  tf("\n");..}.}..
0x0000000000000330: 76 6F 69 64 20 6D 61 69 6E 28 69 6E 74 20 61 72  void main(int ar
0x0000000000000340: 67 63 2C 20 63 68 61 72 20 2A 2A 61 72 67 76 29  gc, char **argv)
0x0000000000000350: 20 7B 0A 09 69 66 20 28 61 72 67 63 20 3C 20 32   {..if (argc < 2
0x0000000000000360: 20 29 7B 0A 09 09 70 72 69 6E 74 66 28 22 55 73   ){...printf("Us
0x0000000000000370: 61 67 65 3A 20 6D 79 66 69 6C 65 64 75 6D 70 20  age: myfiledump 
0x0000000000000380: 66 69 6C 65 20 5B 6D 61 78 62 79 74 65 73 5D 5C  file [maxbytes]\
0x0000000000000390: 6E 22 29 3B 0A 09 09 65 78 69 74 28 31 29 3B 0A  n");...exit(1);.
0x00000000000003A0: 09 7D 0A 09 0A 09 46 49 4C 45 20 2A 20 66 69 6E  .}....FILE * fin
0x00000000000003B0: 20 3D 20 20 66 6F 70 65 6E 28 61 72 67 76 5B 31   =  fopen(argv[1
0x00000000000003C0: 5D 20 2C 20 22 72 22 29 3B 09 0A 09 0A 09 2F 2F  ] , "r");.....//
0x00000000000003D0: 49 6E 76 61 6C 69 64 20 66 69 6C 65 0A 09 69 66  Invalid file..if
0x00000000000003E0: 20 28 66 69 6E 20 3D 3D 20 4E 55 4C 4C 29 7B 0A   (fin == NULL){.
0x00000000000003F0: 09 09 70 72 69 6E 74 66 28 22 45 72 72 6F 72 20  ..printf("Error 
0x0000000000000400: 6F 70 65 6E 69 6E 67 20 66 69 6C 65 20 5C 22 25  opening file \"%
0x0000000000000410: 73 5C 22 5C 6E 22 2C 20 61 72 67 76 5B 31 5D 29  s\"\n", argv[1])
0x0000000000000420: 3B 0A 09 09 65 78 69 74 28 31 29 3B 09 0A 09 7D  ;...exit(1);...}
0x0000000000000430: 0A 0A 0A 09 2F 2F 61 72 67 76 5B 5D 20 69 73 20  ....//argv[] is 
0x0000000000000440: 63 68 61 72 2A 20 7C 7C 20 61 72 67 76 5B 5D 5B  char* || argv[][
0x0000000000000450: 5D 20 69 73 20 63 68 61 72 0A 09 69 6E 74 20 6C  ] is char..int l
0x0000000000000460: 65 6E 20 3D 20 30 3B 0A 09 69 66 20 28 61 72 67  en = 0;..if (arg
0x0000000000000470: 63 20 3E 3D 20 33 29 7B 09 2F 2F 69 66 20 68 61  c >= 3){.//if ha
0x0000000000000480: 76 65 20 6D 61 78 62 79 74 65 73 0A 09 09 6C 65  ve maxbytes...le
0x0000000000000490: 6E 20 20 3D 20 61 74 6F 69 28 61 72 67 76 5B 32  n  = atoi(argv[2
0x00000000000004A0: 5D 29 3B 09 2F 2F 63 68 61 72 20 74 6F 20 69 6E  ]);.//char to in
0x00000000000004B0: 74 0A 0A 09 09 66 73 65 65 6B 28 66 69 6E 2C 20  t....fseek(fin, 
0x00000000000004C0: 30 4C 2C 20 53 45 45 4B 5F 45 4E 44 29 3B 20 20  0L, SEEK_END);  
0x00000000000004D0: 2F 2F 20 47 6F 20 74 6F 20 74 68 65 20 65 6E 64  // Go to the end
0x00000000000004E0: 20 6F 66 20 74 68 65 20 66 69 6C 65 20 66 69 6E   of the file fin
0x00000000000004F0: 0A 20 20 09 09 69 6E 74 20 6C 65 6E 32 20 3D 20  .  ..int len2 = 
0x0000000000000500: 66 74 65 6C 6C 28 66 69 6E 29 3B 20 2F 2F 20 47  ftell(fin); // G
0x0000000000000510: 65 74 20 63 75 72 72 65 6E 74 20 66 69 6C 65 20  et current file 
0x0000000000000520: 70 6F 69 6E 74 65 72 0A 20 20 20 09 09 66 73 65  pointer.   ..fse
0x0000000000000530: 65 6B 28 66 69 6E 2C 20 30 4C 2C 20 53 45 45 4B  ek(fin, 0L, SEEK
0x0000000000000540: 5F 53 45 54 29 3B 20 2F 2F 20 47 6F 20 62 61 63  _SET); // Go bac
0x0000000000000550: 6B 20 74 6F 20 74 68 65 20 62 65 67 69 6E 6E 69  k to the beginni
0x0000000000000560: 6E 67 20 6F 66 20 74 68 65 20 66 69 6C 65 2E 0A  ng of the file..
0x0000000000000570: 09 09 0A 09 09 69 66 28 6C 65 6E 32 20 3C 3D 20  .....if(len2 <= 
0x0000000000000580: 6C 65 6E 29 7B 0A 09 09 09 6C 65 6E 20 3D 20 6C  len){....len = l
0x0000000000000590: 65 6E 32 3B 0A 09 09 0A 09 09 7D 0A 0A 09 7D 65  en2;......}...}e
0x00000000000005A0: 6C 73 65 7B 09 2F 2F 69 66 20 64 6F 65 73 6E 74  lse{.//if doesnt
0x00000000000005B0: 20 68 61 76 65 20 6D 61 78 62 79 74 65 73 0A 09   have maxbytes..
0x00000000000005C0: 09 2F 2F 67 65 74 20 66 69 6C 65 20 73 69 7A 65  .//get file size
0x00000000000005D0: 73 0A 09 09 66 73 65 65 6B 28 66 69 6E 2C 20 30  s...fseek(fin, 0
0x00000000000005E0: 4C 2C 20 53 45 45 4B 5F 45 4E 44 29 3B 20 20 2F  L, SEEK_END);  /
0x00000000000005F0: 2F 20 47 6F 20 74 6F 20 74 68 65 20 65 6E 64 20  / Go to the end 
0x0000000000000600: 6F 66 20 74 68 65 20 66 69 6C 65 20 66 69 6E 0A  of the file fin.
0x0000000000000610: 20 20 09 09 6C 65 6E 20 3D 20 66 74 65 6C 6C 28    ..len = ftell(
0x0000000000000620: 66 69 6E 29 3B 20 2F 2F 20 47 65 74 20 63 75 72  fin); // Get cur
0x0000000000000630: 72 65 6E 74 20 66 69 6C 65 20 70 6F 69 6E 74 65  rent file pointe
0x0000000000000640: 72 0A 20 20 20 09 09 66 73 65 65 6B 28 66 69 6E  r.   ..fseek(fin
0x0000000000000650: 2C 20 30 4C 2C 20 53 45 45 4B 5F 53 45 54 29 3B  , 0L, SEEK_SET);
0x0000000000000660: 20 2F 2F 20 47 6F 20 62 61 63 6B 20 74 6F 20 74   // Go back to t
0x0000000000000670: 68 65 20 62 65 67 69 6E 6E 69 6E 67 20 6F 66 20  he beginning of 
0x0000000000000680: 74 68 65 20 66 69 6C 65 2E 09 0A 09 7D 0A 09 0A  the file....}...
0x0000000000000690: 09 63 68 61 72 20 2A 70 20 3D 20 28 63 68 61 72  .char *p = (char
0x00000000000006A0: 2A 29 20 63 61 6C 6C 6F 63 20 28 6C 65 6E 20 2C  *) calloc (len ,
0x00000000000006B0: 20 73 69 7A 65 6F 66 28 63 68 61 72 29 29 3B 0A   sizeof(char));.
0x00000000000006C0: 09 66 72 65 61 64 20 28 70 2C 20 31 2C 20 6C 65  .fread (p, 1, le
0x00000000000006D0: 6E 2C 20 66 69 6E 29 3B 0A 09 66 69 6C 65 64 75  n, fin);..filedu
0x00000000000006E0: 6D 70 28 70 2C 20 6C 65 6E 29 3B 09 0A 7D 0A 0A  mp(p, len);..}..
0x00000000000006F0: 0A                                               .
